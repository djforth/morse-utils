{"version":3,"file":"index.js","sources":["src/checker.js","src/modules/modal.js","src/modules/alert_close.js","src/modules/cookiebar.js"],"sourcesContent":["import { includes, isArray, isElement } from 'lodash';\n\nconst setData = (type, data) => {\n  switch (type) {\n    case 'Element':\n      return document.getElementById(data); //document.getElementById(data);\n    case 'String':\n      return data;\n    default:\n      try {\n        return JSON.parse(data);\n      } catch (e) {\n        return null;\n      }\n  }\n};\n\nconst checker = (type, dataAttr) => {\n  let valid = false;\n\n  const checks = {\n    Array: isArray,\n    Boolean: d => typeof d === 'boolean',\n    Element: isElement,\n    Number: d => typeof d === 'number',\n    String: d => typeof d === 'string',\n  };\n\n  if (!checks.hasOwnProperty(type)) return false;\n  const data = setData(type, dataAttr);\n  const check = checks[type];\n  return check(data);\n};\n\nconst checkAttributes = attrs =>\n  attrs.reduce((ds, attr) => {\n    if (ds) return true;\n    if (!attr.nodeName) return ds;\n    return attr.nodeName.match(/data/) ? true : false;\n  }, false);\n\nexport default checks => el => {\n  let keys, valid, chKeys;\n  if (!el.attributes) return false;\n  let attrs = Array.prototype.slice.call(el.attributes);\n  if (!checkAttributes(attrs)) return false;\n  keys = Object.keys(el.dataset);\n  chKeys = Object.keys(checks);\n\n  valid = chKeys.reduce((test, ch) => {\n    if (!test) return false;\n    return includes(keys, ch);\n  }, true);\n  if (!valid) return valid;\n\n  return Object.entries(checks).reduce((val, [k, v]) => {\n    if (!val) return val;\n    return checker(v, el.dataset[k]);\n  }, true);\n};\n","import checker from '../checker';\n\nconst closeModal = (modal, lastFocus) => e => {\n  e.preventDefault();\n  e.target.removeEventListener('click', e.target);\n  modal.setAttribute('aria-hidden', 'true');\n  modal.setAttribute('tabindex', '-1');\n  lastFocus.focus();\n};\n\nconst closeBtn = (close, closer) => {\n  close.addEventListener('click', closer);\n};\n\nconst getElements = el => ({\n  close: document.getElementById(el.dataset.closeModal),\n  lastFocus: document.activeElement,\n  modal: document.getElementById(el.dataset.modal),\n});\n\nconst openModal = modal => {\n  modal.setAttribute('aria-hidden', 'false');\n  modal.setAttribute('tabindex', '0');\n  modal.focus();\n};\n\nexport default () => {\n  const btnEl = document.querySelector('[data-modal]');\n\n  if (btnEl) {\n    let { modal: modalEl } = getElements(btnEl);\n\n    modalEl.setAttribute('aria-hidden', 'true');\n    modalEl.setAttribute('tabindex', '-1');\n    modalEl.setAttribute('role', 'dialog');\n  }\n  return {\n    check: checker({ modal: 'Element', closeModal: 'Element' }),\n    trigger: (el, e) => {\n      e.preventDefault();\n      let { close, lastFocus, modal } = getElements(el);\n\n      openModal(modal);\n      closeBtn(close, closeModal(modal, lastFocus));\n    },\n  };\n};\n","import checker from '../checker';\nimport remover from '../remove_element';\n\nimport CookieMgmt from '@djforth/cookie_mgmt_fp';\n\nconst closeAlerts = closed => {\n  closed.forEach(id => {\n    remover(document.getElementById(id));\n  });\n};\n\nexport default () => {\n  let alertsCookie = CookieMgmt('alerts');\n  let value = alertsCookie.getValue();\n  let closed = value ? JSON.parse(alertsCookie.getValue()) : [];\n  if (closed.length > 0) {\n    closeAlerts(closed);\n  }\n\n  return {\n    check: checker({ alert: 'Element' }),\n    trigger: (el, e) => {\n      e.preventDefault();\n      const id = el.dataset.alert;\n      remover(document.getElementById(el.dataset.alert));\n      closed.push(id);\n      alertsCookie.createCookie(JSON.stringify(closed), 365);\n    },\n  };\n};\n","import CookieMgmt from '@djforth/cookie_mgmt_fp';\nimport checker from '../checker';\nimport remover from '../remove_element';\n\nexport default id => {\n  let permission = CookieMgmt('permission');\n  if (permission.getValue()) remover(document.getElementById(id));\n  return {\n    check: checker({ cookiebar: 'Element' }),\n    trigger: (el, e) => {\n      e.preventDefault();\n      remover(document.getElementById(el.dataset.cookiebar));\n      permission.createCookie(true, 365);\n    },\n  };\n};\n"],"names":["checker","type","dataAttr","Array","Boolean","Element","Number","String","checks","hasOwnProperty","data","getElementById","parse","e","setData","valid","el","attributes","reduce","ds","attr","nodeName","match","checkAttributes","prototype","slice","call","keys","Object","dataset","test","ch","_includes","entries","val","k","v","lastFocus","document","activeElement","modal","length","closeAlerts","closed","check","alert","trigger","preventDefault","remover","push","id","alertsCookie","createCookie","JSON","stringify","cookiebar","permission","querySelector","btnEl","modalEl","getElements","setAttribute","closeModal","close","focus","openModal","closeBtn"],"mappings":"moCAiBMA,EAAU,SAACC,EAAMC,GACrB,OAGEC,QACAC,QAAS,kBAAkB,qBAC3BC,UACAC,OAAQ,kBAAkB,oBAC1BC,OAAQ,kBAAkB,qBAG5B,IAAKC,EAAOC,eAAeR,GAAO,SAClC,MA3Bc,SAACA,EAAMS,GACrB,OAAQT,GACN,IAAK,UACH,gBAAgBU,eAAeD,GACjC,IAAK,SACH,SACF,QACE,IACE,YAAYE,MAAMF,GAClB,MAAOG,GACP,cAiBOC,CAAQb,EAAMC,GAE3B,SADcM,EAAOP,IACRS,qCAWb,MAAUK,EACV,QAAKC,EAAGC,eATc,qBAChBC,OAAO,SAACC,EAAIC,WACZD,IACCC,EAAKC,WACHD,EAAKC,SAASC,MAAM,QADAH,QAQxBI,CADOpB,MAAMqB,UAAUC,MAAMC,KAAKV,EAAGC,eAE1CU,EAAOC,OAAOD,KAAKX,EAAGa,UAGtBd,EAFSa,OAAOD,KAAKnB,GAENU,OAAO,SAACY,EAAMC,WACtBD,GACEE,EAASL,EAAMI,SAIjBH,OAAOK,QAAQzB,GAAQU,OAAO,SAACgB,kBAAMC,OAAGC,gBAEtCpC,EAAQoC,EAAGpB,EAAGa,QAAQM,IADZD,OAHAnB,4UCrCnBsB,UAAWC,SAASC,cACpBC,MAAOF,SAAS3B,eAAeK,EAAGa,QAAQW,6ZCE1C,WAJWC,0EACTC,CAAYC,IAIZC,MAAO5C,GAAU6C,MAAO,YACxBC,QAAS,SAAC9B,EAAIH,GACZA,EAAEkC,iBACF,MAAW/B,EAAGa,QAAQgB,MACtBG,EAAQV,SAAS3B,eAAeK,EAAGa,QAAQgB,QAC3CF,EAAOM,KAAKC,GACZC,EAAaC,aAAaC,KAAKC,UAAUX,GAAS,8SCf1CL,SAAS3B,eAAeK,EAAGa,QAAQ0B,YAC3CC,EAAWJ,gBAAmB,qBFelC,MAAcd,SAASmB,cAAc,gBAErC,GAAIC,EAAO,KACIC,EAAYC,EAAYF,GAA/BlB,MAENmB,EAAQE,aAAa,cAAe,QACpCF,EAAQE,aAAa,WAAY,MACjCF,EAAQE,aAAa,OAAQ,UAE/B,OACEjB,MAAO5C,GAAUwC,MAAO,UAAWsB,WAAY,YAC/ChB,QAAS,SAAC9B,EAAIH,GACZA,EAAEkC,uBACgCa,EAAY5C,GAAxC+C,IAAAA,MAAO1B,IAAAA,UAAWG,IAAAA,OApBZ,YAChBA,EAAMqB,aAAa,cAAe,SAClCrB,EAAMqB,aAAa,WAAY,KAC/BrB,EAAMwB,SAmBFC,CAAUzB,+CACV0B,CAASH,qLAAOD,CAAWtB,EAAOH"}